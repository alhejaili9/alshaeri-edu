<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù†Ø¸Ø§Ù… Ø§Ù„Ø´Ø§Ø¹Ø±ÙŠ Ù„Ø¥ØµØ¯Ø§Ø± Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¬Ù„ÙˆØ³</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root { --card-width: 7cm; --card-height: 10cm; --primary-color: #2c3e50; }
        body { font-family: 'Cairo', sans-serif; background-color: #f4f7f6; margin: 0; padding: 20px; }
        .admin-panel { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); max-width: 950px; margin: 0 auto 30px auto; border-top: 6px solid var(--primary-color); }
        .btn-generate { background-color: #27ae60; color: white; padding: 15px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 20px; width: 100%; }
        #printArea { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; }
        .card { width: var(--card-width); height: var(--card-height); border: 1.5px solid #000; background: white; padding: 12px; box-sizing: border-box; display: flex; flex-direction: column; page-break-inside: avoid; }
        .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #000; padding-bottom: 5px; height: 75px; }
        .header img { max-height: 50px; object-fit: contain; }
        .info-row { display: flex; margin-bottom: 12px; font-size: 18px; }
        .label { color: red; font-weight: bold; min-width: 90px; }
        .value { flex: 1; font-weight: bold; text-align: right; }
        .prepared-by { text-align: center; margin-top: 15px; font-weight: bold; }
        @media print { .admin-panel, .no-print { display: none !important; } }
    </style>
</head>
<body>
    <div class="admin-panel">
        <h2 style="text-align:center; color:var(--primary-color);">Ù†Ø¸Ø§Ù… Ø§Ù„Ø´Ø§Ø¹Ø±ÙŠ Ù„Ø¥ØµØ¯Ø§Ø± Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¬Ù„ÙˆØ³</h2>
        <div style="background:#eef2f3; padding:15px; border-radius:8px; margin-bottom:15px;">
            <p style="margin-bottom:10px;">ğŸ“¥ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù† Ø¥ÙƒØ³Ù„:</p>
            <input type="file" accept=".xlsx, .xls" onchange="importFullData(this)">
        </div>
        <button class="btn-generate" onclick="generateCards()">ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª ÙˆØ§Ù„Ø·Ø¨Ø§Ø¹Ø©</button>
        <div class="prepared-by">Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¹Ù„Ù… / Ø¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù† Ø³Ø¹Ø¯ Ø§Ù„Ø­Ø¬ÙŠÙ„ÙŠ</div>
    </div>
    <div id="printArea"></div>

    <script>
        const imgMinistry = "ministry-logo.png"; const imgSchool = "alaqeeq-logo.png";
        let studentsList = [];
        function importFullData(input) {
            const file = input.files[0]; const reader = new FileReader();
            reader.onload = function(e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, {type: 'array'});
                const json = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]], {header: 1});
                studentsList = json.slice(1).map(row => ({ name: row[0], seatNo: row[1], grade: row[2], section: row[3], committee: row[4] }));
                alert("ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­.");
            };
            reader.readAsArrayBuffer(file);
        }
        function generateCards() {
            const area = document.getElementById('printArea'); area.innerHTML = "";
            studentsList.forEach(st => {
                area.innerHTML += `<div class="card">
                    <div class="header"><img src="${imgMinistry}"><div style="font-size:8px; font-weight:bold; text-align:center;">Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©<br>ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù†ÙˆØ±Ø©<br>Ù…Ø¯Ø§Ø±Ø³ Ø§Ù„Ø¹Ù‚ÙŠÙ‚ Ø§Ù„Ø£Ù‡Ù„ÙŠØ©</div><img src="${imgSchool}"></div>
                    <div style="margin-top:20px;">
                        <div class="info-row"><span class="label">Ø§Ù„Ø·Ø§Ù„Ø¨:</span><span class="value">${st.name}</span></div>
                        <div class="info-row"><span class="label">Ø§Ù„ØµÙ:</span><span class="value">${st.grade}</span></div>
                        <div class="info-row"><span class="label">Ø±Ù‚Ù… Ø§Ù„Ù„Ø¬Ù†Ø©:</span><span class="value">${st.committee}</span></div>
                        <div style="text-align:center; border-top:1.5px solid #000; margin-top:20px; padding-top:10px;">
                            <span style="color:red; font-weight:bold; display:block;">Ø±Ù‚Ù… Ø§Ù„Ø¬Ù„ÙˆØ³</span>
                            <span style="font-size:28px; font-weight:bold;">${st.seatNo}</span>
                        </div>
                    </div>
                </div>`;
            });
            setTimeout(() => { window.print(); }, 500);
        }
    </script>
</body>
</html>